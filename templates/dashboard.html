{% extends "base.html" %} {% block content %}

<h1 class="text-3xl font-bold text-center mb-8 text-slate-600">
  Dashboard SIPEDO
</h1>

<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
  <div class="bg-white p-6 rounded-lg shadow-md">
    <h2 class="text-xl font-semibold text-gray-700">Total Donasi</h2>
    <p class="text-3xl font-bold text-slate-600">
      Rp {{ "{:,.0f}".format(total_donasi or 0) }}
    </p>
  </div>

  <div class="bg-white p-6 rounded-lg shadow-md">
    <h2 class="text-xl font-semibold text-gray-700">Total Donatur</h2>
    <p class="text-3xl font-bold text-slate-600">{{ total_donatur or 0 }}</p>
  </div>

  <div class="bg-white p-6 rounded-lg shadow-md">
    <h2 class="text-xl font-semibold text-gray-700">Total Charity</h2>
    <p class="text-3xl font-bold text-slate-600">{{ total_charity or 0 }}</p>
  </div>
</div>

<div class="bg-white p-6 rounded-lg shadow-md mb-10">
  <h2 class="text-2xl font-semibold text-gray-700 mb-4">
    Grafik Donasi Per Bulan
  </h2>
  <canvas id="donasiChart" height="100"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  const bulanLabels = {{ donasi_per_bulan | map(attribute='bulan') | list | tojson }};
  const totalDonasi = {{ donasi_per_bulan | map(attribute='total') | list | tojson }};

  new Chart(document.getElementById('donasiChart'), {
    type: 'line',
    data: {
      labels: bulanLabels.map(b => "Bulan " + b),
      datasets: [{
        label: 'Total Donasi',
        data: totalDonasi,
        borderWidth: 3,
        borderColor: 'rgba(51,65,85,0.9)',
        backgroundColor: 'rgba(51,65,85,0.25)',
        tension: 0.4,
        fill: true
      }]
    }
  });
</script>

<div class="bg-white p-6 rounded-lg shadow-md mb-10">
  <h2 class="text-2xl font-semibold text-gray-700 mb-4">Aktivitas Terbaru</h2>
  <div class="space-y-4">
    {% for item in recent_activities %}
    <div class="p-4 bg-gray-50 rounded-lg shadow-sm">
      <p>
        <strong>{{ item.nama_donatur }}</strong> berdonasi
        <strong>Rp {{ "{:,.0f}".format(item.jumlah_donasi) }}</strong>
        ke <strong>{{ item.nama_charity }}</strong>
      </p>
      <p class="text-sm text-gray-500">{{ item.tanggal_donasi }}</p>
    </div>
    {% endfor %}
  </div>
</div>

{% endblock %}
